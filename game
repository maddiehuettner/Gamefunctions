#game.py
#Maddie Huettner
#10/27/24

#Below is a module docstring that provides an overview of this module.
"""
This is a second file that corresponds to gamefunctions, the adventure game.

It imports functions from the gamefunctions module to interact with
the user and simulate game mechanics. It includes one function docstring.

Functions:
main():
"""

from gamefunctions import print_welcome, print_shop_menu, purchase_item, new_random_monster
import random

#Below is the code for the function display_menu.
#This will display the current status and menu options.
def display_menu(current_hp: int, current_gold: int):
    print(f"\nCurrent HP: {current_hp}, Current Gold: {current_gold}")
    print("What would you like to do?")
    print("1) Fight Monster")
    print("2) Sleep (Restore HP for 5 Gold)")
    print("3) Quit")

#Below is the code for the function get_user_choice.
#This will validate the user input from display_menu.
def get_user_choice() -> int:
    while True:
        try:
            choice = int(input("Enter your choice: "))
            if choice in [1, 2, 3]:
                return choice
            else:
                print("Invalid choice. Please enter a number between 1 and 3.")
        except ValueError:
            print("Invalid input. Please enter a number.")





#Below is the code for the function fight_monster.
#The user is then given a menu where they can either choose to continue fighting or run away.
def fight_monster(user_hp: int, user_power: int) -> int:
    """Handles the combat mechanics between the user and a random monster.

    Parameters:
        user_hp (int): The user's current health points.
        user_power (int): The user's attack power.

    Returns:
        int: The user's remaining health points after the fight.
    """
    monster = new_random_monster()
    monster_hp = monster["Health"]
    print(f"A wild {monster['Name']} appears!")

    while user_hp > 0 and monster_hp > 0:
            #User attacks the monster
            user_damage = user_power + random.randint(0, 5)
            monster_hp -= user_damage
            print(f"You deal {user_damage} damage to the {monster['Name']}!")

            if monster_hp <= 0:
                print(f"You defeated the {monster['Name']}!")
                return user_hp

            # Monster attacks the user
            monster_damage = random.randint(1, monster["Power"])  # Monster damage
            user_hp -= monster_damage
            print(f"The {monster['Name']} deals {monster_damage} damage to you!")

            if user_hp <= 0:
                print("You have been defeated!")
                return 0




def sleep(hp, gold):
    """Restore HP for 5 gold."""
    if gold >= 5:
        hp = min(100, hp + 20)
        gold -= 5
        print("You slept and restored 20 HP.")
    else:
        print("Not enough gold to sleep.")
    return hp, gold





#Below is the code for the function docstring main().
def main():
    name = input("Enter your name: ")
    print_welcome(name)

    print("\nWelcome to the Shop!")
    print_shop_menu("Sword", 50, "Shield", 30)

    item_price = float(input("\nEnter the price of the item you want to buy: "))
    money = float(input("Enter the amount of money you have: "))
    quantity = int(input("Enter the quantity you want to purchase: "))
    
    num_purchased, leftover_money = purchase_item(item_price, money, quantity)
    print(f"You purchased {num_purchased} items. Remaining money: ${leftover_money:.2f}")

    print("\nLet's encounter a random monster!")
    monster = new_random_monster()
    print(f"A wild {monster['Name']} appeared!\n"
          f"Description: {monster['Description']}\n"
          f"Health: {monster['Health']}\n"
          f"Power: {monster['Power']}\n"
          f"Money: {monster['Money']}")

if __name__ == "__main__":
    main()

